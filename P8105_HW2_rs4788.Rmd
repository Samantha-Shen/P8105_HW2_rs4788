---
title: "P8105_HW2_rs4788"
output: html_document
date: "2025-09-30"
---

```{r setup}
library(tidyverse)
library(janitor)
library(readxl)
```

# Problem 1

### First, deal with pols_month data:
```{r}
polse_month = 
  read.csv("./fivethirtyeight_datasets/pols-month.csv") %>%
  janitor::clean_names() %>%
  separate(mon, into = c("year", "month", "day")) %>%
  mutate(month = month.name[as.integer(month)],
         year = as.numeric(year)) %>%
  pivot_longer(
    cols = c(prez_gop, prez_dem),
    names_to = "president",
    names_prefix = "prez_", 
    values_to = "in_office") %>%
  filter(in_office >= 1) %>%
  select(-day, -in_office)
print(polse_month)
```

### Second, deal with snp data:
```{r}
snp = 
  read.csv("./fivethirtyeight_datasets/snp.csv") %>%
  janitor::clean_names() %>%
  separate(date, into = c("month", "day", "year"),sep = "/") %>%
  mutate(
    year = as.integer(year),
    year = ifelse(year <= 25, 2000 + year, 1900 + year),
    month_num = as.integer(month),  
    month = month.name[month_num]
    ) %>%
  select(year, month, close,month_num) %>%
  arrange(year, month_num,close) %>%
  select(-month_num)
print(as_tibble(snp))
```

### Third, tidy the unemployment data:
```{r}
unemploy= 
  read.csv("./fivethirtyeight_datasets/unemployment.csv") %>%
  pivot_longer(
    Jan:Dec,
    names_to = "month_abb" ,
    values_to = "unemployment_rate") %>% 
  mutate(
    month = month.name[match(month_abb, month.abb)] ,
    year=Year,
    year = as.numeric(year)
  ) %>%
  select(year, month, unemployment_rate) %>%
  arrange(year, month)   
print(unemploy)
```

### Join the datasets:
```{r}
final_dataset =
  left_join(polse_month, snp, by =c("year","month")) %>%
  left_join(unemploy, by =c("year","month"))
print(final_dataset)
```

### Describe the datasets:
Based on the analysis of three datasets, we merged political, financial, and employment indicators into a comprehensive dataset spanning 1947 to 2015. The final merged dataset comprises 822 observations and 11 variables, including key variables such as the president's party affiliation, S&P stock market closing prices, and unemployment rates. This enables a cross-domain analysis of U.S. political and economic trends over nearly seven decades.




# Problem 2

### Mr. Trash Wheel sheet:
```{r}
Mr_TW = 
  read_excel("./Mr. Trash Wheel dataset.xlsx",
             sheet = "Mr. Trash Wheel",
             skip = 1,  
             na = c("", "NA", "N/A")) %>%
  janitor::clean_names() %>%
  filter(!is.na(dumpster)) %>%
  mutate(sports_balls = as.integer(round(sports_balls)),
         trash_wheel = "Mr",
         year = as.numeric(year))
print(Mr_TW)
```

### Professor Trash Wheel and Gwynnda sheet:

Professor Trash Wheel sheet:
```{r}
Pro_TW=
  read_excel("./Mr. Trash Wheel dataset.xlsx",
             sheet = "Professor Trash Wheel",
             skip = 1,  
             na = c("", "NA", "N/A")) %>%
  janitor::clean_names() %>%
  filter(!is.na(dumpster)) %>%
  mutate(trash_wheel = "Professor")
print(Pro_TW)
```

Gwynnda Falls Trash Wheel sheet:
```{r}
Gwy_TW = read_excel("./Mr. Trash Wheel dataset.xlsx",
             sheet = "Gwynns Falls Trash Wheel",
             skip = 1,  
             na = c("", "NA", "N/A")) %>%
  janitor::clean_names() %>%
  filter(!is.na(dumpster)) %>%
  mutate(trash_wheel = "Gwynnda")
print(Gwy_TW)
```

### Combine the data sheets:
```{r}
combined_trash_wheel <- bind_rows(Mr_TW, Pro_TW, Gwy_TW)%>%
  select(-x15, -x16)%>%
  select(trash_wheel, everything())
print(combined_trash_wheel)
```

### Describe the data:
The combined trash wheel dataset contains `r nrow(combined_trash_wheel)` observations from three collection devices operating in Baltimore waterways. Key variables include the weight of trash collected (in tons), volume (in cubic yards), and detailed counts of specific waste items such as plastic bottles, cigarette butts, and sports balls.
Professor Trash Wheel collected `r combined_trash_wheel %>% filter(trash_wheel == "Professor") %>% summarize(sum(weight_tons)) %>% pull()` tons of trash total, while Gwynnda collected `r combined_trash_wheel %>% filter(trash_wheel == "Gwynnda", year == 2022, month == "June") %>% summarize(sum(cigarette_butts)) %>% pull()` cigarette butts in June 2022. These data demonstrate the substantial environmental impact of these innovative trash collection systems.



